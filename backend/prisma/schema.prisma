// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int       @id @default(autoincrement())
  password  String
  name      String
  email     String    @unique
  createdAt DateTime  @default(now())
  tests     Test[]
  results   Result[]
}

model Test {
  id        Int         @id @default(autoincrement())
  subject   Subject     @relation(fields: [subjectId], references: [id])
  subjectId Int
  title     String
  createdAt DateTime    @default(now())
  questions Question[]
  submitted Boolean     @default(false)
  score     Int?
  user      User        @relation(fields: [userId], references: [id])
  userId    Int
  results   Result[]
}

model Question {
  id          Int        @id @default(autoincrement())
  question    String
  options     String[]
  answer      String
  explanation String
  difficulty  Difficulty @default(MEDIUM)
  subject     Subject    @relation(fields: [subjectId], references: [id])
  subjectId   Int
  topic       Topic      @relation(fields: [topicId], references: [id])
  topicId     Int
  test        Test?      @relation(fields: [testId], references: [id])
  testId      Int?
}

model Subject {
  id        Int        @id @default(autoincrement())
  name      String
  topics    Topic[]
  questions Question[]
  tests     Test[]
}

model Topic {
  id        Int        @id @default(autoincrement())
  name      String
  subject   Subject    @relation(fields: [subjectId], references: [id])
  subjectId Int
  questions Question[]
}

model Result {
  id      Int   @id @default(autoincrement())
  test    Test  @relation(fields: [testId], references: [id])
  testId  Int
  score   Int
  user    User  @relation(fields: [userId], references: [id])
  userId  Int
  createdAt DateTime @default(now())
}

enum Difficulty {
  EASY
  MEDIUM
  HARD
}